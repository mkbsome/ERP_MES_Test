# ERP/MES UI 시나리오 설계 - AI 플랫폼 연계

## 1. 개요

### 1.1 목적
- AI Factory Decision Engine 시연/테스트를 위한 ERP/MES 시뮬레이터 UI
- 실제 제조 현장의 데이터 흐름과 AI 판단 연계 포인트 시연
- Judgment Engine, Workflow Service 트리거 및 결과 확인

### 1.2 대상 기업 프로필
- **회사명**: (주)그린보드 일렉트로닉스
- **업종**: PCB/전자부품 제조
- **규모**: 중견기업 (2개 공장, 15개 생산라인)
- **제품군**: 스마트폰 메인보드, 전원보드, LED 드라이버, 자동차 ECU, IoT 모듈

---

## 2. AI 플랫폼 연계 시나리오

### 시나리오 1: 품질 이상 감지 및 자동 판단

```
[트리거] MES 불량 등록 → [Judgment] 불량률 분석 → [Workflow] 조치 권고
```

**UI 연계 포인트:**
1. **MES > 품질관리 > 불량등록** 화면에서 불량 데이터 입력
2. 불량률이 임계치(2.5%) 초과 시 Judgment API 자동 호출
3. **알림센터**에서 AI 판단 결과 확인 (warning/critical)
4. **조치관리** 화면에서 권고 조치 확인 및 실행

**Judgment Input 예시:**
```json
{
  "workflow_id": "defect_rule_pack",
  "input_data": {
    "line_id": "SMT-L01",
    "shift": "night",
    "date": "2024-07-15",
    "defect_rate": 0.035,
    "defect_count": 48,
    "total_production": 1370,
    "top_defect_types": [{"type": "BRIDGE", "count": 25}, {"type": "OPEN", "count": 15}]
  }
}
```

---

### 시나리오 2: 설비 이상 예측 및 유지보수 요청

```
[트리거] MES 설비 상태 변경 → [Judgment] OEE 분석 → [Workflow] PM 요청 생성
```

**UI 연계 포인트:**
1. **MES > 설비관리 > 설비현황** 화면에서 설비 상태 모니터링
2. OEE가 목표(85%) 대비 10% 이상 하락 시 Judgment 호출
3. **설비보전 > 보전요청** 화면에서 자동 생성된 PM 티켓 확인
4. **ERP > 구매관리**와 연계하여 예비부품 발주

**Judgment Input 예시:**
```json
{
  "workflow_id": "equipment_health_check",
  "input_data": {
    "equipment_code": "SMT-L01-M02",
    "oee_current": 0.72,
    "oee_target": 0.85,
    "downtime_events": [
      {"code": "ALARM_FEEDER", "count": 5, "total_minutes": 45}
    ],
    "last_pm_date": "2024-06-15",
    "pm_interval_days": 30
  }
}
```

---

### 시나리오 3: 자재 부족 예측 및 자동 발주

```
[트리거] ERP 재고 변동 → [Judgment] 수요 예측 → [Workflow] 발주 요청
```

**UI 연계 포인트:**
1. **MES > 자재관리 > 자재투입** 화면에서 자재 소모 등록
2. 안전재고 도달 시 Judgment API 호출 (수요 예측)
3. **ERP > 구매관리 > 발주등록** 화면에서 자동 생성된 발주 확인
4. 승인 워크플로우 연동

---

### 시나리오 4: 생산 계획 최적화

```
[트리거] ERP 수주 등록 → [Judgment] 납기 분석 → [Workflow] 생산계획 조정
```

**UI 연계 포인트:**
1. **ERP > 판매관리 > 수주등록** 화면에서 긴급 수주 입력
2. 납기 Risk 분석 Judgment 호출
3. **ERP > 생산관리 > 작업지시** 화면에서 우선순위 자동 조정
4. **MES > 생산관리 > 작업현황**에서 변경 사항 확인

---

### 시나리오 5: BI 자연어 질의 (Chat Interface)

```
[트리거] Chat 질의 → [Judgment] Intent 분석 → [BI Service] 데이터 조회 → 차트 표시
```

**UI 연계 포인트:**
1. **AI 어시스턴트** 채팅 화면에서 자연어 질의
2. "L01 라인 이번 주 불량률 추이 보여줘"
3. BI Service가 분석 계획 생성 및 실행
4. 결과 차트를 채팅 화면에 임베드

---

## 3. ERP 필요 기능 (UI 화면)

### 3.1 판매관리 (SD)

| 화면 | 기능 | AI 연계 포인트 |
|------|------|---------------|
| 수주등록 | 수주 생성/수정/삭제 | 납기 Risk 분석 트리거 |
| 수주조회 | 수주 목록 조회/검색 | - |
| 수주현황 | 수주 진행 상태 | 납기 지연 경고 표시 |
| 출하등록 | 출하 처리 | - |
| 출하조회 | 출하 내역 조회 | - |

### 3.2 구매관리 (MM)

| 화면 | 기능 | AI 연계 포인트 |
|------|------|---------------|
| 발주등록 | 발주 생성/수정 | AI 자동 발주 요청 |
| 발주조회 | 발주 목록 조회 | - |
| 입고등록 | 자재 입고 처리 | 품질 검사 연계 |
| 입고조회 | 입고 내역 조회 | - |
| 공급업체관리 | 공급업체 마스터 | 공급업체 평가 표시 |

### 3.3 재고관리 (IM)

| 화면 | 기능 | AI 연계 포인트 |
|------|------|---------------|
| 재고현황 | 품목별 재고 조회 | 재고 부족 경고 |
| 재고이동 | 창고간 이동 | - |
| 재고조정 | 실사 조정 | - |
| 자재마스터 | 자재 정보 관리 | - |
| 안전재고설정 | 안전재고/발주점 | AI 추천 적용 |

### 3.4 생산관리 (PP)

| 화면 | 기능 | AI 연계 포인트 |
|------|------|---------------|
| BOM조회 | BOM 구조 조회 | - |
| 작업지시등록 | 생산지시 생성 | 우선순위 AI 추천 |
| 작업지시조회 | 생산지시 목록 | - |
| MRP실행 | 소요량 계산 | - |
| 생산계획 | MPS 관리 | AI 최적화 제안 |

### 3.5 품질관리 (QM)

| 화면 | 기능 | AI 연계 포인트 |
|------|------|---------------|
| 수입검사 | 입고 품질 검사 | 합격률 분석 |
| 출하검사 | 출하 전 검사 | - |
| 부적합관리 | 불량 처리 | Root Cause 분석 연계 |
| 시정조치 | CAR 관리 | AI 조치 권고 |

---

## 4. MES 필요 기능 (UI 화면)

### 4.1 생산실행

| 화면 | 기능 | AI 연계 포인트 |
|------|------|---------------|
| 작업현황 | 라인별 작업 현황 | 실시간 모니터링 |
| 실적등록 | 생산 실적 입력 | 불량률 이상 감지 |
| 실적조회 | 실적 내역 조회 | - |
| Lot추적 | 로트 이력 조회 | - |
| 작업지시확인 | MES 작업지시 수신 | ERP 연동 상태 |

### 4.2 설비관리

| 화면 | 기능 | AI 연계 포인트 |
|------|------|---------------|
| 설비현황 | 설비 상태 모니터링 | OEE 이상 감지 |
| 설비마스터 | 설비 정보 관리 | - |
| 가동현황 | 가동률 분석 | 가동률 하락 경고 |
| 알람이력 | 설비 알람 조회 | 패턴 분석 연계 |
| 보전요청 | PM 요청 관리 | AI 자동 생성 |

### 4.3 품질관리

| 화면 | 기능 | AI 연계 포인트 |
|------|------|---------------|
| 불량등록 | 불량 데이터 입력 | **핵심 트리거** |
| 불량조회 | 불량 이력 조회 | 불량 패턴 분석 |
| SPC차트 | 관리도 조회 | 이상 패턴 감지 |
| 검사결과 | AOI/SPI 결과 | - |

### 4.4 자재관리

| 화면 | 기능 | AI 연계 포인트 |
|------|------|---------------|
| 자재투입 | 라인 자재 투입 | 재고 소진 예측 |
| 피더현황 | SMT 피더 상태 | - |
| 릴관리 | 자재 릴 추적 | - |
| 자재요청 | 라인 자재 요청 | - |

---

## 5. 공통 기능

### 5.1 AI 연계 공통 화면

| 화면 | 기능 | 설명 |
|------|------|------|
| AI 어시스턴트 | Chat 인터페이스 | 자연어 질의 및 명령 |
| 알림센터 | AI 판단 결과 | Judgment 결과 알림 |
| 조치관리 | 권고 조치 목록 | Workflow 생성 조치 |
| AI 판단 이력 | Judgment 로그 | 판단 이력 및 Replay |

### 5.2 대시보드

| 화면 | 기능 | AI 연계 |
|------|------|--------|
| 종합현황 | KPI 요약 | 이상 지표 하이라이트 |
| 생산현황 | 생산 모니터링 | 실시간 데이터 |
| 품질현황 | 불량률 추이 | 품질 Alert 표시 |
| 설비현황 | OEE 모니터링 | 설비 Alert 표시 |

---

## 6. UI 우선순위

### Phase 1: Core (MVP)
1. **MES 불량등록** - Judgment 핵심 트리거
2. **MES 설비현황** - OEE 모니터링
3. **알림센터** - AI 판단 결과 확인
4. **종합현황 대시보드** - KPI 확인

### Phase 2: ERP Integration
5. **ERP 수주등록/조회** - 수주 관리
6. **ERP 작업지시** - 생산 계획
7. **ERP 발주등록/조회** - 구매 관리
8. **ERP 재고현황** - 재고 모니터링

### Phase 3: Advanced
9. **AI 어시스턴트** - Chat 인터페이스
10. **조치관리** - Workflow 결과
11. **AI 판단 이력** - Replay 기능
12. 추가 CRUD 화면들

---

## 7. 데이터 흐름

### 7.1 ERP → MES
```
수주 → 작업지시 → MES 작업지시 배포
```
- Interface: `erp_mes_work_order_if`

### 7.2 MES → ERP
```
생산실적 → ERP 생산실적 확정 → 재고 반영
```
- Interface: `mes_erp_production_if`

### 7.3 MES → AI Platform
```
불량 데이터 → Judgment API → 판단 결과 → Workflow → 조치
```
- API: `POST /api/v2/judgment/execute`

### 7.4 AI Platform → UI
```
Judgment 결과 → WebSocket/Webhook → 알림센터 표시
```
- WebSocket: 실시간 알림
- Webhook: `judgment.critical`, `judgment.warning`

---

## 8. 기술 스택

### Frontend
- **Framework**: React 18 + TypeScript
- **State**: TanStack Query (서버 상태) + Zustand (클라이언트 상태)
- **UI**: Tailwind CSS + shadcn/ui
- **Charts**: Recharts
- **Table**: TanStack Table
- **Form**: React Hook Form + Zod
- **Router**: React Router v6

### API Integration
- REST API (ERP/MES CRUD)
- WebSocket (실시간 모니터링)
- AI Platform API (Judgment/Workflow/BI)

---

## 9. 화면 목록 정리

### ERP (14개 화면)
1. 수주등록
2. 수주조회
3. 출하등록
4. 발주등록
5. 발주조회
6. 입고등록
7. 재고현황
8. 자재마스터
9. BOM조회
10. 작업지시등록
11. 작업지시조회
12. 수입검사
13. 부적합관리
14. 시정조치

### MES (12개 화면)
1. 작업현황
2. 실적등록
3. 실적조회
4. Lot추적
5. 설비현황
6. 설비마스터
7. 보전요청
8. 불량등록
9. 불량조회
10. SPC차트
11. 자재투입
12. 피더현황

### 공통 (6개 화면)
1. 종합현황 대시보드
2. AI 어시스턴트
3. 알림센터
4. 조치관리
5. AI 판단 이력
6. 설정

**총: 32개 화면**

---

## 10. 다음 단계

1. Phase 1 화면 상세 설계 (와이어프레임)
2. 공통 컴포넌트 개발 (DataTable, Form, Modal)
3. API 모킹 및 연동 테스트
4. Phase 1 화면 구현
