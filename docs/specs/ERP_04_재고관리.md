# ERP 재고관리 모듈 기능정의서

## 1. 모듈 개요

| 항목 | 내용 |
|------|------|
| 모듈 ID | ERP-IM |
| 모듈명 | 재고관리 (Inventory Management) |
| 화면 수 | 6개 |
| 목적 | 원자재, 재공품, 완제품의 재고 현황 관리 및 이동 처리 |
| 대상 사용자 | 자재팀, 생산팀, 물류팀 |
| 핵심 기능 | 재고현황 조회, 재고이동, 재고실사, 안전재고 관리 |

## 2. 화면 목록

| 화면 ID | 화면명 | 우선순위 | 설명 |
|---------|--------|----------|------|
| ERP-IM-001 | 재고현황 조회 | P1 | 품목별/창고별 실시간 재고 조회 |
| ERP-IM-002 | 재고이동 처리 | P1 | 창고간/로케이션간 재고 이동 |
| ERP-IM-003 | 재고조정 | P1 | 재고 수량 조정 (입고/출고/폐기) |
| ERP-IM-004 | 재고실사 | P2 | 정기/수시 재고 실사 관리 |
| ERP-IM-005 | 안전재고 관리 | P1 | 안전재고 설정 및 알림 |
| ERP-IM-006 | 재고 분석 | P2 | 재고회전율, ABC 분석 |

---

## 3. 화면별 상세 정의

### 3.1 ERP-IM-001: 재고현황 조회

#### 3.1.1 화면 목적
- 품목별, 창고별 실시간 재고 현황 조회

#### 3.1.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 재고현황 조회                                    [엑셀] [인쇄]  │
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 품목유형: [○전체 ●원자재 ○재공품 ○완제품]                  │ │
│ │ 창고: [전체        ▼]  품목: [                  ]          │ │
│ │ 재고상태: [▣전체 ☑정상 ☑안전재고이하 ☑과잉재고]   [검색]  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 재고 요약 ───────────────────────────────────────────────┐ │
│ │ 총 품목수: 3,256개  │  재고금액: 2,850,000,000원           │ │
│ │ 안전재고 이하: 45개 │  과잉재고: 23개                       │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 재고현황 상세 ───────────────────────────────────────────┐ │
│ │ 품목코드   │품명        │창고  │현재고│예약│가용│안전재고│상태│ │
│ │───────────┼───────────┼─────┼─────┼───┼───┼──────┼──│ │
│ │ RES-0402-10│칩저항 10KΩ│자재창│150K │20K│130K│50K    │정상│ │
│ │ CAP-0603-10│MLCC 10uF  │자재창│30K  │10K│20K │25K    │🟡 │ │
│ │ IC-MCU-32  │MCU STM32  │자재창│500  │200│300 │1K     │🔴 │ │
│ │ PCB-MB-001 │스마트폰메인│완제품│2,500│500│2,000│1K     │정상│ │
│ │ PCB-PW-001 │전원보드   │완제품│5,000│0  │5,000│500    │🟢+│ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 상태 범례 ───────────────────────────────────────────────┐ │
│ │ 🔴 안전재고 미달 (50% 이하)  │ 🟡 안전재고 임박 (50-80%)   │ │
│ │ 정상 (80-150%)              │ 🟢+ 과잉재고 (150% 초과)     │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 품목 상세 (RES-0402-10K) ────────────────────────────────┐ │
│ │ ┌─ 창고별 재고 ─────────────────────────────────────────┐ │ │
│ │ │ 창고     │로케이션  │LOT번호    │수량  │입고일  │상태 │ │ │
│ │ │─────────┼─────────┼──────────┼─────┼──────┼────│ │ │
│ │ │ 자재창고 │A-01-01  │GR24012301│50,000│01-23 │정상 │ │ │
│ │ │ 자재창고 │A-01-02  │GR24012001│60,000│01-20 │정상 │ │ │
│ │ │ SMT라인1 │LINE-01  │GR24012301│40,000│01-25 │사용중│ │ │
│ │ └─────────────────────────────────────────────────────────┘ │ │
│ │                                                             │ │
│ │ ┌─ 최근 입출고 이력 ────────────────────────────────────┐ │ │
│ │ │ 일자    │유형│수량  │관련문서   │비고              │ │ │
│ │ │────────┼───┼─────┼─────────┼────────────────│ │ │
│ │ │ 01-25  │출고│-40,000│WO24012501│SMT-L01 라인투입 │ │ │
│ │ │ 01-23  │입고│+50,000│GR24012301│삼성전기 입고    │ │ │
│ │ │ 01-20  │입고│+60,000│GR24012001│삼성전기 입고    │ │ │
│ │ └─────────────────────────────────────────────────────────┘ │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.1.3 데이터 항목

**재고 테이블 (erp_inventory_stock)**

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| stock_id | SERIAL | Y | 재고 ID (PK) |
| item_code | VARCHAR(20) | Y | 품목코드 |
| warehouse_code | VARCHAR(10) | Y | 창고코드 |
| location_code | VARCHAR(20) | N | 로케이션 코드 |
| lot_no | VARCHAR(30) | N | LOT번호 |
| qty | INT | Y | 현재고 수량 |
| reserved_qty | INT | Y | 예약 수량 |
| available_qty | INT | Y | 가용 수량 (현재고 - 예약) |
| unit_cost | DECIMAL(15,2) | N | 단위원가 |
| stock_value | DECIMAL(15,2) | N | 재고금액 |
| receive_date | DATE | N | 입고일자 |
| expire_date | DATE | N | 유효기한 |
| status | VARCHAR(10) | Y | 상태 (정상/보류/폐기예정) |

#### 3.1.4 비즈니스 로직
```
1. 가용재고 계산
   - 가용재고 = 현재고 - 예약수량
   - 예약수량: 출하지시, 생산지시에 의해 예약된 수량

2. 재고상태 판정
   - 안전재고 대비 비율로 상태 결정
   - 50% 이하: 🔴 긴급
   - 50-80%: 🟡 주의
   - 80-150%: 정상
   - 150% 초과: 🟢+ 과잉

3. 재고금액 계산
   - 이동평균법 또는 선입선출법 적용
   - 재고금액 = 수량 × 단위원가

4. LOT 추적
   - LOT별 재고 수량 관리
   - 입고일 기준 선입선출 관리
```

---

### 3.2 ERP-IM-002: 재고이동 처리

#### 3.2.1 화면 목적
- 창고간, 로케이션간 재고 이동 처리

#### 3.2.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 재고이동 처리                                 [신규] [저장] [확정]│
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 이동일자: [2024-01-01] ~ [2024-01-31]  상태: [전체    ▼]  │ │
│ │ 이동유형: [전체    ▼]  이동번호: [              ]  [검색]  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 이동 목록 ───────────────────────────────────────────────┐ │
│ │ 이동번호    │이동일자│유형    │출고창고│입고창고│상태│담당자│ │
│ │─────────────┼───────┼───────┼──────┼──────┼──┼────│ │
│ │ TR24010001  │01-25  │창고이동│자재창고│SMT-L01│확정│김자재│ │
│ │ TR24010002  │01-26  │라인투입│자재창고│SMT-L02│대기│이자재│ │
│ │ TR24010003  │01-26  │반품   │SMT-L01│자재창고│확정│박자재│ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 이동 등록 ───────────────────────────────────────────────┐ │
│ │ 이동번호: [TR24010004   ]  이동일자: [2024-01-27]          │ │
│ │ 이동유형: [라인투입    ▼]  담당자: [김자재     ]           │ │
│ │ 출고창고: [자재창고    ▼]  입고창고: [SMT-L01    ▼]        │ │
│ │ 비고: [생산지시 WO24012701 자재 투입                     ] │ │
│ │                                                             │ │
│ │ ┌─ 이동 품목 ────────────────────────────────────────────┐│ │
│ │ │ No│품목코드    │품명      │LOT번호   │가용재고│이동수량│││ │
│ │ │───┼───────────┼─────────┼─────────┼──────┼──────│││ │
│ │ │ 1 │RES-0402-10K│칩저항10K │GR24012301│50,000 │[30,000]│││ │
│ │ │ 2 │CAP-0603-10U│MLCC 10uF│GR24012301│20,000 │[15,000]│││ │
│ │ │ 3 │IC-MCU-32   │MCU STM32│GR24012001│300    │[200   ]│││ │
│ │ └─────────────────────────────────────────────────────────┘│ │
│ │                                        [품목추가] [품목삭제]│ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.2.3 데이터 항목

**재고이동 (erp_inventory_transfer)**

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| transfer_no | VARCHAR(12) | Y | 이동번호 (TR+년월+일련번호) |
| transfer_date | DATE | Y | 이동일자 |
| transfer_type | VARCHAR(20) | Y | 이동유형 (창고이동/라인투입/반품/로케이션이동) |
| from_warehouse | VARCHAR(10) | Y | 출고창고 |
| to_warehouse | VARCHAR(10) | Y | 입고창고 |
| status | VARCHAR(10) | Y | 상태 (대기/확정/취소) |
| handler | VARCHAR(50) | Y | 담당자 |
| remarks | VARCHAR(500) | N | 비고 |
| work_order_no | VARCHAR(12) | N | 참조 작업지시번호 |

#### 3.2.4 비즈니스 로직
```
1. 이동 유형
   - 창고이동: 창고 간 재고 이동
   - 라인투입: 자재창고 → 생산라인
   - 반품: 생산라인 → 자재창고 (미사용 자재)
   - 로케이션이동: 동일 창고 내 위치 변경

2. 이동 확정
   - 출고창고 재고 차감
   - 입고창고 재고 증가
   - LOT 정보 유지
   - 재고이력 기록

3. MES 연동
   - 라인투입 시 → MES 자재투입 정보 연동
   - 생산지시번호 참조 시 자동 연동
```

---

### 3.3 ERP-IM-003: 재고조정

#### 3.3.1 화면 목적
- 재고 수량 조정 (입고, 출고, 폐기 등)

#### 3.3.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 재고조정                                      [신규] [저장] [승인]│
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 조정일자: [2024-01-01] ~ [2024-01-31]  상태: [전체    ▼]  │ │
│ │ 조정유형: [전체    ▼]  조정번호: [              ]  [검색]  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 조정 목록 ───────────────────────────────────────────────┐ │
│ │ 조정번호    │조정일자│유형  │창고  │품목수│상태│담당자│승인자│ │
│ │─────────────┼───────┼─────┼─────┼─────┼──┼────┼────│ │
│ │ AD24010001  │01-25  │실사차│자재창│15   │승인│김자재│이팀장│ │
│ │ AD24010002  │01-26  │폐기 │자재창│3    │대기│박자재│-    │ │
│ │ AD24010003  │01-27  │기타입│완제품│2    │승인│최자재│이팀장│ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 조정 등록 ───────────────────────────────────────────────┐ │
│ │ 조정번호: [AD24010004   ]  조정일자: [2024-01-28]          │ │
│ │ 조정유형: [실사차이    ▼]  창고: [자재창고    ▼]           │ │
│ │ 담당자: [김자재       ]  조정사유: [정기 재고실사 차이조정]│ │
│ │                                                             │ │
│ │ ┌─ 조정 품목 ────────────────────────────────────────────┐│ │
│ │ │ No│품목코드    │품명      │LOT번호   │장부재고│실재고│차이 ││ │
│ │ │───┼───────────┼─────────┼─────────┼──────┼─────┼────││ │
│ │ │ 1 │RES-0402-10K│칩저항10K │GR24012301│50,000 │49,850│-150││ │
│ │ │ 2 │CAP-0603-10U│MLCC 10uF│GR24012301│20,000 │20,000│0   ││ │
│ │ │ 3 │IC-MCU-32   │MCU STM32│GR24012001│300    │295  │-5  ││ │
│ │ └─────────────────────────────────────────────────────────┘│ │
│ │                                                             │ │
│ │ 조정합계: -155개 (재고감소)                                 │ │
│ │ 첨부파일: [실사보고서.pdf 🔗]                    [파일첨부]  │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.3.3 데이터 항목

**재고조정 (erp_inventory_adjustment)**

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| adjust_no | VARCHAR(12) | Y | 조정번호 (AD+년월+일련번호) |
| adjust_date | DATE | Y | 조정일자 |
| adjust_type | VARCHAR(20) | Y | 조정유형 (실사차이/폐기/기타입고/기타출고/손실) |
| warehouse_code | VARCHAR(10) | Y | 창고코드 |
| status | VARCHAR(10) | Y | 상태 (대기/승인/반려) |
| handler | VARCHAR(50) | Y | 담당자 |
| approver | VARCHAR(50) | N | 승인자 |
| approved_at | TIMESTAMP | N | 승인일시 |
| reason | VARCHAR(500) | Y | 조정사유 |

#### 3.3.4 비즈니스 로직
```
1. 조정 유형
   - 실사차이: 재고실사 결과 차이 조정
   - 폐기: 불량/유효기한 초과 등 폐기
   - 기타입고: 무상샘플, 반환 등
   - 기타출고: 샘플출고, 테스트용 등
   - 손실: 분실, 파손 등

2. 승인 프로세스
   - 조정수량 또는 금액에 따른 승인 권한
   - 100만원 이하: 팀장 승인
   - 100만원 초과: 임원 승인

3. 재고 반영
   - 승인 시 재고 수량 자동 반영
   - 재고이력에 조정 내역 기록
   - 회계 전표 연동 (재고자산 조정)
```

---

### 3.4 ERP-IM-004: 재고실사

#### 3.4.1 화면 목적
- 정기/수시 재고 실사 계획 및 실행 관리

#### 3.4.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 재고실사                              [실사계획] [실사시작] [마감]│
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 실사기간: [2024-01-01] ~ [2024-01-31]  상태: [전체    ▼]  │ │
│ │ 실사유형: [전체    ▼]  창고: [전체        ▼]      [검색]   │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 실사 목록 ───────────────────────────────────────────────┐ │
│ │ 실사번호    │실사기간      │유형  │창고  │대상품목│상태│담당│ │
│ │─────────────┼─────────────┼─────┼─────┼──────┼──┼───│ │
│ │ IC24010001  │01-25~01-27 │정기 │자재창│1,256  │마감│김자재│ │
│ │ IC24010002  │01-28~01-28 │수시 │완제품│45    │진행│이자재│ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 실사 상세 (IC24010002) ──────────────────────────────────┐ │
│ │ 실사번호: IC24010002      │  상태: 진행중                  │ │
│ │ 실사기간: 2024-01-28      │  담당자: 이자재                │ │
│ │ 대상창고: 완제품창고       │  대상품목: 45개               │ │
│ │                                                             │ │
│ │ ┌─ 실사 진행현황 ────────────────────────────────────────┐│ │
│ │ │ 진행률: ████████████░░░░░░░░ 65% (30/45)              ││ │
│ │ │ 일치: 25개  │  차이: 5개  │  미실사: 15개              ││ │
│ │ └─────────────────────────────────────────────────────────┘│ │
│ │                                                             │ │
│ │ ┌─ 실사 품목 ────────────────────────────────────────────┐│ │
│ │ │ No│품목코드  │품명      │장부재고│실사수량│차이│상태   ││ │
│ │ │───┼─────────┼─────────┼──────┼──────┼───┼─────││ │
│ │ │ 1 │PCB-MB-001│스마트폰메인│2,500 │[2,500 ]│0  │일치  ││ │
│ │ │ 2 │PCB-PW-001│전원보드   │5,000 │[4,985 ]│-15│차이  ││ │
│ │ │ 3 │PCB-LED-01│LED드라이버│3,200 │[      ]│-  │미실사││ │
│ │ └─────────────────────────────────────────────────────────┘│ │
│ │                                                             │ │
│ │ 차이 품목 처리: [▣ 자동 재고조정 생성]                      │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.4.3 비즈니스 로직
```
1. 실사 유형
   - 정기실사: 월말/분기말 전수 실사
   - 수시실사: 특정 품목/창고 실사
   - ABC실사: A품목은 월별, B품목은 분기별, C품목은 반기별

2. 실사 프로세스
   - 실사계획 생성 → 대상 품목 확정
   - 실사 시작 → 장부재고 스냅샷 저장
   - 실사 입력 → 실재고 수량 입력
   - 실사 마감 → 차이 분석 및 조정

3. 재고조정 연동
   - 차이 품목 자동 재고조정 생성
   - 조정번호 연결
```

---

### 3.5 ERP-IM-005: 안전재고 관리

#### 3.5.1 화면 목적
- 품목별 안전재고 설정 및 알림 관리

#### 3.5.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 안전재고 관리                                    [저장] [일괄설정]│
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 품목유형: [전체      ▼]  품목군: [전체        ▼]          │ │
│ │ 상태필터: [▣전체 ☑미달 ☑임박 □정상 □과잉]        [검색]  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 안전재고 현황 요약 ──────────────────────────────────────┐ │
│ │ 🔴 미달 (50% 이하): 12개   │  🟡 임박 (50-80%): 28개      │ │
│ │ 정상 (80-150%): 3,150개   │  🟢 과잉 (150% 초과): 66개    │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 안전재고 설정 ───────────────────────────────────────────┐ │
│ │ 품목코드   │품명        │현재고│안전재고│발주점│상태│리드타임│ │
│ │───────────┼───────────┼─────┼──────┼─────┼──┼──────│ │
│ │ RES-0402-10│칩저항 10KΩ│130K │[50K  ]│[80K ]│정상│7일    │ │
│ │ CAP-0603-10│MLCC 10uF  │20K  │[25K  ]│[40K ]│🟡 │10일   │ │
│ │ IC-MCU-32  │MCU STM32  │300  │[1K   ]│[1.5K]│🔴 │14일   │ │
│ │ PCB-MB-001 │스마트폰메인│2,000│[1K   ]│[1.5K]│정상│3일    │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 알림 설정 ───────────────────────────────────────────────┐ │
│ │ 안전재고 미달 알림: [▣ 사용]  담당자: [구매팀, 자재팀    ] │ │
│ │ 발주점 도달 알림:  [▣ 사용]  담당자: [구매팀            ] │ │
│ │ 알림 방식: [▣ 시스템알림 ☑ 이메일 □ SMS]                  │ │
│ │ 알림 주기: [매일 오전 9시]                                  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 자동 발주 설정 ──────────────────────────────────────────┐ │
│ │ 자동 발주 생성: [□ 사용]                                   │ │
│ │ 발주점 도달 시 자동 구매요청 생성                          │ │
│ │ 발주량 = (안전재고 × 1.5) - 현재고 - 발주중수량            │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.5.3 데이터 항목

**안전재고 설정 (erp_safety_stock)**

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| item_code | VARCHAR(20) | Y | 품목코드 (PK) |
| safety_stock | INT | Y | 안전재고 수량 |
| reorder_point | INT | Y | 발주점 수량 |
| max_stock | INT | N | 최대재고 수량 |
| lead_time_days | INT | N | 조달 리드타임 (일) |
| auto_order_yn | CHAR(1) | N | 자동발주 여부 (Y/N) |
| alert_enabled | CHAR(1) | Y | 알림 사용 여부 |

#### 3.5.4 비즈니스 로직
```
1. 안전재고 산정 공식
   - 안전재고 = 평균일일소비량 × 리드타임 × 안전계수
   - 안전계수: 서비스 수준에 따라 1.5~2.0

2. 발주점 산정
   - 발주점 = 안전재고 + (평균일일소비량 × 리드타임)
   - 발주점 도달 시 구매 프로세스 시작

3. 알림 로직
   - 매일 배치 작업으로 재고 상태 체크
   - 미달/임박 품목 알림 발송
   - 대시보드에 경고 표시

4. AI 연동 (선택)
   - 수요 예측 기반 안전재고 권장
   - 계절성, 트렌드 반영
```

---

### 3.6 ERP-IM-006: 재고 분석

#### 3.6.1 화면 목적
- 재고회전율, ABC 분석 등 재고 성과 분석

#### 3.6.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 재고 분석                                        [엑셀] [인쇄]  │
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 분석조건 ─────────────────────────────────────────────────┐ │
│ │ 분석기간: [2024-01-01] ~ [2024-03-31]                       │ │
│ │ 분석유형: [○회전율분석 ●ABC분석 ○장기재고 ○불용재고]       │ │
│ │ 품목유형: [전체      ▼]  창고: [전체        ▼]    [분석]   │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ ABC 분석 요약 ───────────────────────────────────────────┐ │
│ │ 등급│품목수│비율│재고금액      │금액비율│회전율│관리방침    │ │
│ │────┼────┼───┼────────────┼──────┼────┼──────────│ │
│ │ A  │326 │10%│1,995,000,000│70%   │12.5│정밀관리    │ │
│ │ B  │652 │20%│570,000,000 │20%   │8.2 │일반관리    │ │
│ │ C  │2,278│70%│285,000,000 │10%   │4.5 │간소관리    │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ ABC 등급 분포 (차트) ────────────────────────────────────┐ │
│ │                                                             │ │
│ │   금액비중         품목비중                                 │ │
│ │   ┌───┐          ┌───────────────────┐                    │ │
│ │   │ A │70%       │ C (70%)            │                    │ │
│ │   │   │          │                    │                    │ │
│ │   ├───┤          ├────┤               │                    │ │
│ │   │B│20%        │B(20)│               │                    │ │
│ │   ├─┤           ├──┤                 │                    │ │
│ │   │C│10%        │A│                   │                    │ │
│ │   └─┘           └──┘                  │                    │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ A등급 품목 상세 ─────────────────────────────────────────┐ │
│ │ 순위│품목코드  │품명        │재고금액   │회전율│출고빈도│ │
│ │────┼─────────┼───────────┼──────────┼─────┼──────│ │
│ │ 1  │IC-MCU-32 │MCU STM32   │250,000,000│15.2 │매일   │ │
│ │ 2  │IC-MEM-128│메모리칩128M │180,000,000│18.5 │매일   │ │
│ │ 3  │PCB-MB-001│스마트폰메인 │150,000,000│12.0 │주3회  │ │
│ │ 4  │CON-HDMI-1│HDMI커넥터  │120,000,000│10.5 │주2회  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 재고회전율 추이 ─────────────────────────────────────────┐ │
│ │     15 ┤      ┌─┐           ┌─┐                           │ │
│ │     12 ┤ ┌─┐ │ │      ┌─┐ │ │                           │ │
│ │      9 ┤ │ │ │ │ ┌─┐ │ │ │ │                           │ │
│ │      6 ┤ │ │ │ │ │ │ │ │ │ │                           │ │
│ │      3 ┤ │ │ │ │ │ │ │ │ │ │                           │ │
│ │      0 ┼─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴──                       │ │
│ │         1월   2월   3월                                    │ │
│ │        ■ A등급  □ B등급  ░ C등급                          │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.6.3 분석 지표

| 지표 | 산출 공식 | 설명 |
|------|----------|------|
| 재고회전율 | 출고금액 / 평균재고금액 | 재고가 얼마나 빨리 회전하는지 |
| 재고일수 | 365 / 재고회전율 | 평균 재고 보유 기간 |
| ABC 분류 | 파레토 법칙 (70-20-10) | 금액 기준 품목 분류 |
| 장기재고율 | 6개월이상 미출고 / 총재고 | 장기 체류 재고 비율 |

---

## 4. 테이블 설계

### 4.1 재고 (erp_inventory_stock)
```sql
CREATE TABLE erp_inventory_stock (
    stock_id SERIAL PRIMARY KEY,
    item_code VARCHAR(20) NOT NULL,
    warehouse_code VARCHAR(10) NOT NULL,
    location_code VARCHAR(20),
    lot_no VARCHAR(30),
    qty INT NOT NULL DEFAULT 0,
    reserved_qty INT NOT NULL DEFAULT 0,
    available_qty INT GENERATED ALWAYS AS (qty - reserved_qty) STORED,
    unit_cost DECIMAL(15,2),
    stock_value DECIMAL(15,2),
    receive_date DATE,
    expire_date DATE,
    status VARCHAR(10) DEFAULT '정상',
    last_movement_date DATE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (item_code) REFERENCES erp_item_master(item_code),
    FOREIGN KEY (warehouse_code) REFERENCES erp_warehouse_master(warehouse_code),
    UNIQUE (item_code, warehouse_code, location_code, lot_no)
);
```

### 4.2 재고이력 (erp_inventory_transaction)
```sql
CREATE TABLE erp_inventory_transaction (
    trans_id SERIAL PRIMARY KEY,
    trans_date DATE NOT NULL,
    trans_type VARCHAR(20) NOT NULL,  -- 입고/출고/이동/조정
    item_code VARCHAR(20) NOT NULL,
    warehouse_code VARCHAR(10) NOT NULL,
    lot_no VARCHAR(30),
    qty INT NOT NULL,  -- 양수: 증가, 음수: 감소
    before_qty INT,
    after_qty INT,
    unit_cost DECIMAL(15,2),
    reference_type VARCHAR(20),  -- GR/SH/TR/AD/WO 등
    reference_no VARCHAR(20),    -- 관련 문서번호
    remarks VARCHAR(200),
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (item_code) REFERENCES erp_item_master(item_code),
    FOREIGN KEY (warehouse_code) REFERENCES erp_warehouse_master(warehouse_code)
);
```

### 4.3 재고이동 (erp_inventory_transfer)
```sql
CREATE TABLE erp_inventory_transfer (
    transfer_no VARCHAR(12) PRIMARY KEY,
    transfer_date DATE NOT NULL,
    transfer_type VARCHAR(20) NOT NULL,
    from_warehouse VARCHAR(10) NOT NULL,
    to_warehouse VARCHAR(10) NOT NULL,
    status VARCHAR(10) DEFAULT '대기',
    handler VARCHAR(50) NOT NULL,
    work_order_no VARCHAR(12),
    remarks VARCHAR(500),
    confirmed_at TIMESTAMP,
    confirmed_by VARCHAR(50),
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (from_warehouse) REFERENCES erp_warehouse_master(warehouse_code),
    FOREIGN KEY (to_warehouse) REFERENCES erp_warehouse_master(warehouse_code)
);
```

### 4.4 재고조정 (erp_inventory_adjustment)
```sql
CREATE TABLE erp_inventory_adjustment (
    adjust_no VARCHAR(12) PRIMARY KEY,
    adjust_date DATE NOT NULL,
    adjust_type VARCHAR(20) NOT NULL,
    warehouse_code VARCHAR(10) NOT NULL,
    status VARCHAR(10) DEFAULT '대기',
    handler VARCHAR(50) NOT NULL,
    approver VARCHAR(50),
    approved_at TIMESTAMP,
    reason VARCHAR(500) NOT NULL,
    inventory_count_no VARCHAR(12),
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (warehouse_code) REFERENCES erp_warehouse_master(warehouse_code)
);
```

### 4.5 재고실사 (erp_inventory_count)
```sql
CREATE TABLE erp_inventory_count (
    count_no VARCHAR(12) PRIMARY KEY,
    count_type VARCHAR(20) NOT NULL,  -- 정기/수시/ABC
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    warehouse_code VARCHAR(10) NOT NULL,
    status VARCHAR(10) DEFAULT '계획',  -- 계획/진행/마감
    total_items INT DEFAULT 0,
    counted_items INT DEFAULT 0,
    matched_items INT DEFAULT 0,
    diff_items INT DEFAULT 0,
    handler VARCHAR(50) NOT NULL,
    closed_at TIMESTAMP,
    closed_by VARCHAR(50),
    remarks VARCHAR(500),
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (warehouse_code) REFERENCES erp_warehouse_master(warehouse_code)
);
```

---

## 5. API 설계

### 5.1 재고현황 API
```
GET    /api/erp/inventory/stock           재고현황 조회
GET    /api/erp/inventory/stock/{item_code}  품목별 재고 상세
GET    /api/erp/inventory/stock/warehouse/{code}  창고별 재고
GET    /api/erp/inventory/transaction     재고이력 조회
```

### 5.2 재고이동 API
```
POST   /api/erp/inventory/transfer        재고이동 등록
GET    /api/erp/inventory/transfer        재고이동 목록 조회
GET    /api/erp/inventory/transfer/{no}   재고이동 상세 조회
POST   /api/erp/inventory/transfer/{no}/confirm  이동 확정
DELETE /api/erp/inventory/transfer/{no}   이동 취소
```

### 5.3 재고조정 API
```
POST   /api/erp/inventory/adjustment      재고조정 등록
GET    /api/erp/inventory/adjustment      재고조정 목록 조회
POST   /api/erp/inventory/adjustment/{no}/approve  조정 승인
DELETE /api/erp/inventory/adjustment/{no}  조정 취소
```

### 5.4 재고실사 API
```
POST   /api/erp/inventory/count           실사 계획 등록
GET    /api/erp/inventory/count           실사 목록 조회
POST   /api/erp/inventory/count/{no}/start   실사 시작
PUT    /api/erp/inventory/count/{no}/item    실사 입력
POST   /api/erp/inventory/count/{no}/close   실사 마감
```

### 5.5 안전재고 API
```
GET    /api/erp/inventory/safety-stock    안전재고 조회
PUT    /api/erp/inventory/safety-stock    안전재고 설정
GET    /api/erp/inventory/safety-stock/alert  부족 품목 알림
```

### 5.6 분석 API
```
GET    /api/erp/inventory/analysis/turnover   재고회전율 분석
GET    /api/erp/inventory/analysis/abc        ABC 분석
GET    /api/erp/inventory/analysis/aging      장기재고 분석
```

---

## 6. MES 연동

### 6.1 라인투입 연동
```
ERP 재고이동 (라인투입) 확정 시:
→ mes_erp_goods_movement_if 테이블에 기록
→ MES 피더설정 시 사용 가능 자재 표시

movement_type: 'LINE_IN' (라인투입)
- item_code, qty, lot_no, to_location (라인코드)
```

### 6.2 생산완료 연동
```
MES 생산완료 시:
→ ERP 재고 반영 (완제품 입고)

movement_type: 'PRODUCTION' (생산)
- item_code (완제품), qty, lot_no, warehouse_code
```

### 6.3 자재소비 연동
```
MES 자재투입 실적:
→ ERP 재고 차감

movement_type: 'CONSUMPTION' (소비)
- item_code, qty, lot_no, work_order_no
```

---

## 7. 초기 데이터

### 7.1 창고 코드
| 코드 | 명칭 | 용도 |
|------|------|------|
| WH-RM | 원자재창고 | 원자재/부품 보관 |
| WH-WIP | 재공품창고 | 생산 중 반제품 보관 |
| WH-FG | 완제품창고 | 완제품 보관 |
| WH-BAD | 불량창고 | 불량품 격리 보관 |
| SMT-L01 | SMT라인1 | 라인사이드 재고 |
| SMT-L02 | SMT라인2 | 라인사이드 재고 |

### 7.2 이동유형 코드
| 코드 | 명칭 | 설명 |
|------|------|------|
| WH_MOVE | 창고이동 | 창고 간 이동 |
| LINE_IN | 라인투입 | 생산라인 자재 투입 |
| LINE_OUT | 라인반품 | 라인에서 창고로 반품 |
| LOC_MOVE | 로케이션이동 | 동일 창고 내 위치 이동 |

### 7.3 조정유형 코드
| 코드 | 명칭 | 설명 |
|------|------|------|
| COUNT_DIFF | 실사차이 | 재고실사 차이 조정 |
| SCRAP | 폐기 | 불량/유효기한 초과 폐기 |
| OTHER_IN | 기타입고 | 무상샘플, 반환 등 |
| OTHER_OUT | 기타출고 | 샘플출고, 테스트용 등 |
| LOSS | 손실 | 분실, 파손 등 |
