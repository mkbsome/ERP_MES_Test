# ERP 구매관리 모듈 기능정의서

## 1. 모듈 개요

| 항목 | 내용 |
|------|------|
| 모듈 ID | ERP-MM |
| 모듈명 | 구매관리 (Material Management) |
| 화면 수 | 8개 |
| 목적 | 자재 발주부터 입고, 매입 처리까지 구매 프로세스 전반 관리 |
| 대상 사용자 | 구매팀, 자재팀, 회계팀 |
| 핵심 기능 | 발주 관리, 입고 처리, 매입 관리, 공급업체 평가 |

## 2. 화면 목록

| 화면 ID | 화면명 | 우선순위 | 설명 |
|---------|--------|----------|------|
| ERP-MM-001 | 구매요청 관리 | P1 | 자재 구매 요청 등록/승인 |
| ERP-MM-002 | 발주서 관리 | P1 | 발주서 생성/발행/조회 |
| ERP-MM-003 | 발주현황 조회 | P1 | 발주 진행 상태 모니터링 |
| ERP-MM-004 | 입고 처리 | P1 | 자재 입고 등록/검수 |
| ERP-MM-005 | 입고현황 조회 | P1 | 입고 내역 조회/분석 |
| ERP-MM-006 | 매입전표 관리 | P1 | 매입 전표 생성/관리 |
| ERP-MM-007 | 공급업체 평가 | P2 | 공급업체 성과 평가 |
| ERP-MM-008 | 구매 통계 | P2 | 구매 실적 분석/리포트 |

---

## 3. 화면별 상세 정의

### 3.1 ERP-MM-001: 구매요청 관리

#### 3.1.1 화면 목적
- 각 부서에서 필요한 자재 구매 요청을 등록하고 승인 처리

#### 3.1.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 구매요청 관리                                    [신규] [저장]  │
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 요청일자: [2024-01-01] ~ [2024-01-31]  상태: [전체    ▼]  │ │
│ │ 요청부서: [전체        ▼]  담당자: [         ]  [검색]    │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 구매요청 목록 ───────────────────────────────────────────┐ │
│ │ 요청번호    │요청일자  │요청부서│담당자│상태  │요청금액   │ │
│ │─────────────┼─────────┼───────┼─────┼─────┼──────────│ │
│ │ PR24010001  │2024-01-15│생산팀 │김생산│승인  │5,500,000  │ │
│ │ PR24010002  │2024-01-16│품질팀 │이품질│대기  │1,200,000  │ │
│ │ PR24010003  │2024-01-17│생산팀 │박생산│반려  │3,800,000  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 구매요청 상세 ───────────────────────────────────────────┐ │
│ │ 요청번호: [PR24010001   ]  요청일자: [2024-01-15]          │ │
│ │ 요청부서: [생산팀      ▼]  담당자: [김생산     ]          │ │
│ │ 희망납기: [2024-01-25    ]  긴급여부: [□]                  │ │
│ │ 요청사유: [생산 증가에 따른 부품 추가 발주 필요          ]│ │
│ │                                                             │ │
│ │ ┌─ 요청품목 ─────────────────────────────────────────────┐│ │
│ │ │ No│품목코드    │품명            │규격      │수량│단가  ││ │
│ │ │───┼───────────┼───────────────┼─────────┼───┼──────││ │
│ │ │ 1 │RES-0402-10K│칩저항 10KΩ    │0402     │50K│20    ││ │
│ │ │ 2 │CAP-0603-10U│MLCC 10uF      │0603     │30K│35    ││ │
│ │ │ 3 │IC-MCU-32   │MCU STM32F103  │LQFP48   │2K │2,500 ││ │
│ │ └─────────────────────────────────────────────────────────┘│ │
│ │                           [품목추가] [품목삭제] [승인] [반려]│ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.1.3 데이터 항목

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| pr_no | VARCHAR(12) | Y | 구매요청번호 (PR+년월+일련번호) |
| pr_date | DATE | Y | 요청일자 |
| dept_code | VARCHAR(10) | Y | 요청부서 코드 |
| requester | VARCHAR(50) | Y | 요청자 |
| due_date | DATE | Y | 희망납기일 |
| urgent_yn | CHAR(1) | N | 긴급여부 (Y/N) |
| reason | VARCHAR(500) | N | 요청사유 |
| status | VARCHAR(10) | Y | 상태 (대기/승인/반려/완료) |
| total_amount | DECIMAL(15,2) | Y | 총 요청금액 |

#### 3.1.4 비즈니스 로직
```
1. 구매요청 생성
   - 요청번호 자동채번: PR + 년월(4자리) + 일련번호(4자리)
   - 초기 상태: '대기'
   - 희망납기: 최소 요청일 + 3영업일

2. 승인 처리
   - 권한: 구매팀장 이상
   - 승인 시 상태 → '승인'
   - 금액 5,000,000원 이상: 추가 결재 필요

3. 반려 처리
   - 반려 사유 필수 입력
   - 요청자에게 알림 발송
```

---

### 3.2 ERP-MM-002: 발주서 관리

#### 3.2.1 화면 목적
- 승인된 구매요청을 기반으로 공급업체에 발주서 생성 및 발행

#### 3.2.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 발주서 관리                           [신규] [저장] [발행] [인쇄]│
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 발주일자: [2024-01-01] ~ [2024-01-31]  상태: [전체    ▼]  │ │
│ │ 공급업체: [               ]  발주번호: [         ]  [검색] │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 발주서 목록 ─────────────────────────────────────────────┐ │
│ │ 발주번호    │발주일자  │공급업체      │납기    │상태│금액     │ │
│ │─────────────┼─────────┼─────────────┼───────┼───┼────────│ │
│ │ PO24010001  │2024-01-15│삼성전기(주)  │01-25  │발행│15,500,000│ │
│ │ PO24010002  │2024-01-16│(주)한국부품  │01-30  │작성│8,200,000 │ │
│ │ PO24010003  │2024-01-17│대한전자부품  │02-01  │입고완│5,800,000 │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 발주서 상세 ─────────────────────────────────────────────┐ │
│ │ 발주번호: [PO24010001   ]  발주일자: [2024-01-15]          │ │
│ │ 공급업체: [삼성전기(주) ▼]  담당자: [홍길동     ]          │ │
│ │ 납기일자: [2024-01-25    ]  결제조건: [월말 30일 ▼]        │ │
│ │ 납품장소: [본사 자재창고  ]  비고: [               ]        │ │
│ │                                                             │ │
│ │ ┌─ 발주품목 ─────────────────────────────────────────────┐│ │
│ │ │ No│품목코드    │품명          │규격    │수량  │단가│금액    ││ │
│ │ │───┼───────────┼─────────────┼───────┼─────┼───┼───────││ │
│ │ │ 1 │RES-0402-10K│칩저항 10KΩ  │0402   │50,000│20 │1,000,000││ │
│ │ │ 2 │CAP-0603-10U│MLCC 10uF    │0603   │30,000│35 │1,050,000││ │
│ │ │ 3 │IC-MCU-32   │MCU STM32    │LQFP48 │2,000 │2,500│5,000,000││ │
│ │ │───┼───────────┼─────────────┼───────┼─────┼───┼───────││ │
│ │ │                                    합계:     │7,050,000││ │
│ │ │                                    VAT(10%): │705,000  ││ │
│ │ │                                    총액:     │7,755,000││ │
│ │ └─────────────────────────────────────────────────────────┘│ │
│ │                                      [품목추가] [품목삭제]  │ │
│ │ 참조 구매요청: [PR24010001] [요청서조회]                    │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.2.3 데이터 항목

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| po_no | VARCHAR(12) | Y | 발주번호 (PO+년월+일련번호) |
| po_date | DATE | Y | 발주일자 |
| vendor_code | VARCHAR(10) | Y | 공급업체 코드 |
| vendor_name | VARCHAR(100) | N | 공급업체명 |
| due_date | DATE | Y | 납기일자 |
| payment_term | VARCHAR(20) | Y | 결제조건 |
| delivery_loc | VARCHAR(100) | Y | 납품장소 |
| status | VARCHAR(10) | Y | 상태 (작성/발행/부분입고/입고완료/취소) |
| total_amount | DECIMAL(15,2) | Y | 공급가액 |
| vat_amount | DECIMAL(15,2) | Y | 부가세 |
| grand_total | DECIMAL(15,2) | Y | 총액 |
| pr_no | VARCHAR(12) | N | 참조 구매요청번호 |

#### 3.2.4 비즈니스 로직
```
1. 발주서 생성
   - 발주번호 자동채번: PO + 년월(4자리) + 일련번호(4자리)
   - 구매요청에서 자동 생성 또는 직접 입력
   - 초기 상태: '작성'

2. 발주 발행
   - 상태 → '발행'
   - 발행일시 기록
   - 공급업체 이메일/FAX 발송 (선택)
   - MES 시스템 연동 (자재 입고 예정 등록)

3. 단가 적용 규칙
   - 단가계약 우선 적용
   - 최근 3개월 입고 단가 참조
   - 견적 단가 적용
```

---

### 3.3 ERP-MM-003: 발주현황 조회

#### 3.3.1 화면 목적
- 발주 진행 상태 모니터링 및 납기 관리

#### 3.3.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 발주현황 조회                                         [엑셀]    │
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 발주일자: [2024-01-01] ~ [2024-01-31]  납기일자 기준: [□]  │ │
│ │ 상태: [▣전체 ☑발행 ☑부분입고 □입고완료]                    │ │
│ │ 공급업체: [            ▼]  품목: [              ]  [검색]  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 발주현황 ────────────────────────────────────────────────┐ │
│ │ 발주번호  │발주일│공급업체    │품목코드  │품명      │발주│입고│잔량│납기  │D-Day│ │
│ │──────────┼─────┼──────────┼────────┼────────┼───┼───┼───┼─────┼────│ │
│ │ PO24010001│01-15│삼성전기   │RES-0402 │칩저항10K│50K│30K│20K│01-25│D-3 │ │
│ │ PO24010001│01-15│삼성전기   │CAP-0603 │MLCC10uF│30K│30K│0  │01-25│완료│ │
│ │ PO24010002│01-16│한국부품   │IC-MCU-32│STM32   │2K │0  │2K │01-30│D-7 │ │
│ │ PO24010003│01-17│대한전자   │PCB-MB-01│메인보드│1K │1K │0  │02-01│완료│ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 납기 알림 ───────────────────────────────────────────────┐ │
│ │ 🔴 납기 지연 (D+3 이상): 2건                                │ │
│ │ 🟡 납기 임박 (D-3 이내): 5건                                │ │
│ │ 🟢 정상 진행: 15건                                          │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.3.3 비즈니스 로직
```
1. D-Day 계산
   - 납기일 - 현재일
   - D-3 이내: 황색 경고
   - D+1 이상: 적색 경고 (납기 지연)

2. 잔량 계산
   - 잔량 = 발주수량 - 누적입고수량
   - 잔량 0: 입고 완료 처리

3. 자동 알림
   - 납기 D-3 시점: 담당자 알림
   - 납기 지연 시: 관리자 에스컬레이션
```

---

### 3.4 ERP-MM-004: 입고 처리

#### 3.4.1 화면 목적
- 발주 자재의 입고 등록 및 검수 처리

#### 3.4.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 입고 처리                              [신규] [저장] [입고확정]  │
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 발주서 조회 ─────────────────────────────────────────────┐ │
│ │ 발주번호: [PO24010001 🔍]  공급업체: 삼성전기(주)           │ │
│ │ 발주일자: 2024-01-15      납기일자: 2024-01-25             │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 입고 정보 ───────────────────────────────────────────────┐ │
│ │ 입고번호: [GR24010001   ]  입고일자: [2024-01-23]          │ │
│ │ 입고창고: [자재창고    ▼]  입고담당: [박자재     ]          │ │
│ │ 거래명세표: [2024-0123-001]  차량번호: [12가3456   ]        │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 입고 품목 ───────────────────────────────────────────────┐ │
│ │ No│품목코드    │품명        │발주량│기입고│금회입고│검수 │비고│ │
│ │───┼───────────┼───────────┼─────┼─────┼───────┼────┼───│ │
│ │ 1 │RES-0402-10K│칩저항 10KΩ│50,000│30,000│[20,000]│[합격▼]│   │ │
│ │ 2 │CAP-0603-10U│MLCC 10uF  │30,000│30,000│[     ]│[   ▼]│완료│ │
│ │ 3 │IC-MCU-32   │MCU STM32  │2,000 │0     │[2,000 ]│[합격▼]│   │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 검수 결과 ───────────────────────────────────────────────┐ │
│ │ 검수일자: [2024-01-23]  검수자: [이품질    ]               │ │
│ │ 불합격 품목:                                                │ │
│ │  - RES-0402-10K: 100개 외관불량 → 반품처리                 │ │
│ │ 검수의견: [외관검사 합격, 일부 반품 처리 예정            ] │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.4.3 데이터 항목

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| gr_no | VARCHAR(12) | Y | 입고번호 (GR+년월+일련번호) |
| gr_date | DATE | Y | 입고일자 |
| po_no | VARCHAR(12) | Y | 발주번호 |
| warehouse_code | VARCHAR(10) | Y | 입고창고 |
| receiver | VARCHAR(50) | Y | 입고담당자 |
| invoice_no | VARCHAR(30) | N | 거래명세표 번호 |
| status | VARCHAR(10) | Y | 상태 (입고중/검수완료/확정) |

**입고 상세 (erp_goods_receipt_detail)**

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| gr_no | VARCHAR(12) | Y | 입고번호 |
| seq | INT | Y | 순번 |
| item_code | VARCHAR(20) | Y | 품목코드 |
| po_qty | INT | Y | 발주수량 |
| prev_gr_qty | INT | Y | 기입고수량 |
| gr_qty | INT | Y | 금회입고수량 |
| inspect_result | VARCHAR(10) | Y | 검수결과 (합격/불합격/보류) |
| reject_qty | INT | N | 불합격수량 |
| reject_reason | VARCHAR(200) | N | 불합격사유 |
| lot_no | VARCHAR(30) | N | LOT번호 |

#### 3.4.4 비즈니스 로직
```
1. 입고 등록
   - 발주서 조회 후 입고수량 입력
   - 입고수량 ≤ 잔량 검증
   - LOT번호 자동생성 또는 입력

2. 검수 처리
   - 품목별 검수결과 입력 (합격/불합격/보류)
   - 불합격 시: 불합격수량, 사유 필수
   - 품질검사 연동 (수입검사 필요 품목)

3. 입고 확정
   - 재고 반영 (erp_inventory_stock 증가)
   - 발주서 상태 업데이트
   - MES 자재 입고 정보 연동

4. MES 연동
   - 입고 확정 시 → mes_erp_goods_movement_if 등록
   - LOT 정보 공유 (추적성 확보)
```

---

### 3.5 ERP-MM-005: 입고현황 조회

#### 3.5.1 화면 목적
- 입고 내역 조회 및 통계 분석

#### 3.5.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 입고현황 조회                                    [엑셀] [인쇄]  │
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 입고일자: [2024-01-01] ~ [2024-01-31]                       │ │
│ │ 공급업체: [            ▼]  품목: [              ]          │ │
│ │ 검수결과: [▣전체 ☑합격 ☑불합격]                   [검색]   │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 입고 요약 ───────────────────────────────────────────────┐ │
│ │ 총 입고건수: 45건  │  입고금액: 128,500,000원              │ │
│ │ 합격률: 98.5%      │  불합격금액: 1,925,000원              │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 입고 내역 ───────────────────────────────────────────────┐ │
│ │ 입고번호  │입고일│발주번호  │공급업체  │품목    │수량 │금액    │검수│ │
│ │──────────┼─────┼─────────┼────────┼───────┼────┼───────┼──│ │
│ │ GR24010001│01-23│PO24010001│삼성전기 │칩저항  │20K │400,000│합격│ │
│ │ GR24010002│01-23│PO24010001│삼성전기 │MCU    │2K │5,000,000│합격│ │
│ │ GR24010003│01-24│PO24010002│한국부품 │커넥터 │5K │750,000│불합│ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

---

### 3.6 ERP-MM-006: 매입전표 관리

#### 3.6.1 화면 목적
- 입고 확정 건에 대한 매입 전표 생성 및 관리

#### 3.6.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 매입전표 관리                          [신규] [저장] [전기] [삭제]│
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 검색조건 ─────────────────────────────────────────────────┐ │
│ │ 전표일자: [2024-01-01] ~ [2024-01-31]  상태: [전체    ▼]  │ │
│ │ 공급업체: [               ]  전표번호: [         ]  [검색] │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 매입전표 목록 ───────────────────────────────────────────┐ │
│ │ 전표번호    │전표일자│공급업체    │공급가액  │VAT     │합계     │상태│ │
│ │─────────────┼───────┼──────────┼────────┼───────┼───────┼──│ │
│ │ PI24010001  │2024-01│삼성전기   │5,400,000│540,000│5,940,000│전기│ │
│ │ PI24010002  │2024-01│한국부품   │2,200,000│220,000│2,420,000│작성│ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 매입전표 상세 ───────────────────────────────────────────┐ │
│ │ 전표번호: [PI24010001   ]  전표일자: [2024-01-25]          │ │
│ │ 공급업체: [삼성전기(주)  ]  사업자번호: [123-45-67890]      │ │
│ │ 세금계산서: [2024-01-0001]  발행일자: [2024-01-25]          │ │
│ │                                                             │ │
│ │ ┌─ 전표 품목 ────────────────────────────────────────────┐│ │
│ │ │ 입고번호  │품목코드    │품명        │수량  │단가│공급가액  ││ │
│ │ │──────────┼───────────┼───────────┼─────┼───┼────────││ │
│ │ │ GR24010001│RES-0402-10K│칩저항 10KΩ│20,000│20 │400,000  ││ │
│ │ │ GR24010002│IC-MCU-32   │MCU STM32  │2,000 │2,500│5,000,000││ │
│ │ │───────────┼───────────┼───────────┼─────┼───┼────────││ │
│ │ │                                   공급가액: │5,400,000││ │
│ │ │                                   VAT:     │540,000  ││ │
│ │ │                                   합계:    │5,940,000││ │
│ │ └─────────────────────────────────────────────────────────┘│ │
│ │ 결제예정일: [2024-02-25]  결제조건: [월말30일▼]             │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.6.3 데이터 항목

| 필드명 | 타입 | 필수 | 설명 |
|--------|------|------|------|
| pi_no | VARCHAR(12) | Y | 매입전표번호 (PI+년월+일련번호) |
| pi_date | DATE | Y | 전표일자 |
| vendor_code | VARCHAR(10) | Y | 공급업체 코드 |
| tax_invoice_no | VARCHAR(30) | N | 세금계산서 번호 |
| tax_invoice_date | DATE | N | 세금계산서 발행일 |
| supply_amount | DECIMAL(15,2) | Y | 공급가액 |
| vat_amount | DECIMAL(15,2) | Y | 부가세 |
| total_amount | DECIMAL(15,2) | Y | 합계금액 |
| payment_due_date | DATE | Y | 결제예정일 |
| status | VARCHAR(10) | Y | 상태 (작성/전기/결제완료) |

#### 3.6.4 비즈니스 로직
```
1. 매입전표 생성
   - 입고 확정 건 기준 자동 생성 가능
   - 복수 입고 건 합산 가능

2. 전기 처리
   - 회계 전표 자동 생성
     차변: 원재료(자산) / 대변: 외상매입금(부채)
     차변: 부가세대급금 / 대변: 외상매입금
   - 상태 → '전기'

3. 결제예정일 계산
   - 결제조건에 따라 자동 계산
   - 현금: 전표일
   - 월말30일: 익월 말일
   - 60일: 전표일 + 60일
```

---

### 3.7 ERP-MM-007: 공급업체 평가

#### 3.7.1 화면 목적
- 공급업체 성과 평가 및 등급 관리

#### 3.7.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 공급업체 평가                                    [평가실행] [저장]│
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 평가조건 ─────────────────────────────────────────────────┐ │
│ │ 평가기간: [2024-01-01] ~ [2024-03-31] (분기)               │ │
│ │ 평가대상: [▣전체 ☑A등급 ☑B등급 ☑C등급]         [평가실행]  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 평가 결과 요약 ──────────────────────────────────────────┐ │
│ │ 평가대상: 25개사  │  A등급: 5개사 │ B등급: 15개사 │ C등급: 5개사│
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 공급업체별 평가 ─────────────────────────────────────────┐ │
│ │ 공급업체    │납기준수│품질점수│가격경쟁│협력도│총점│등급│전기│ │
│ │────────────┼───────┼───────┼───────┼─────┼───┼───┼──│ │
│ │ 삼성전기    │95점   │98점   │85점   │90점 │92 │A  │A │ │
│ │ 한국부품    │85점   │88점   │90점   │85점 │87 │B  │B │ │
│ │ 대한전자    │70점   │75점   │95점   │80점 │80 │B  │C↑│ │
│ │ 신흥전자    │60점   │65점   │98점   │70점 │73 │C  │C │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 평가 상세 (삼성전기) ────────────────────────────────────┐ │
│ │ 1. 납기준수율 (30%): 95점                                  │ │
│ │    - 총 발주건수: 45건, 납기준수: 43건 (95.6%)             │ │
│ │                                                             │ │
│ │ 2. 품질점수 (30%): 98점                                    │ │
│ │    - 입고검사 합격률: 98.2%                                 │ │
│ │    - 클레임 건수: 1건                                       │ │
│ │                                                             │ │
│ │ 3. 가격경쟁력 (25%): 85점                                  │ │
│ │    - 시장가 대비: 102% (약간 높음)                          │ │
│ │                                                             │ │
│ │ 4. 협력도 (15%): 90점                                      │ │
│ │    - 긴급대응: 양호, 기술지원: 우수                         │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.7.3 평가 기준

| 평가항목 | 가중치 | 산출 기준 |
|----------|--------|-----------|
| 납기준수율 | 30% | (정시납품건수 / 총납품건수) × 100 |
| 품질점수 | 30% | 입고검사 합격률, 클레임 건수 반영 |
| 가격경쟁력 | 25% | 시장가 대비 단가 수준 |
| 협력도 | 15% | 긴급대응, 기술지원, 의사소통 평가 |

**등급 기준**:
- A등급: 90점 이상 (우수)
- B등급: 70-89점 (양호)
- C등급: 50-69점 (보통)
- D등급: 50점 미만 (개선필요)

---

### 3.8 ERP-MM-008: 구매 통계

#### 3.8.1 화면 목적
- 구매 실적 분석 및 리포트 제공

#### 3.8.2 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────────┐
│ 구매 통계                                        [엑셀] [인쇄]  │
├─────────────────────────────────────────────────────────────────┤
│ ┌─ 분석조건 ─────────────────────────────────────────────────┐ │
│ │ 분석기간: [2024-01-01] ~ [2024-03-31]                       │ │
│ │ 분석유형: [○월별 ●공급업체별 ○품목별 ○품목군별]  [분석]   │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 구매 요약 ───────────────────────────────────────────────┐ │
│ │ 총 발주금액: 1,285,000,000원  │  총 입고금액: 1,156,500,000원│ │
│ │ 발주건수: 156건              │  입고건수: 142건             │ │
│ │ 평균납기준수율: 91.2%        │  평균품질합격률: 97.8%       │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 공급업체별 구매현황 ─────────────────────────────────────┐ │
│ │ 순위│공급업체    │발주금액    │비중  │발주건│납기준수│품질│ │
│ │────┼──────────┼──────────┼─────┼─────┼──────┼───│ │
│ │ 1  │삼성전기   │385,000,000│30.0%│45   │95.6% │98.2%│ │
│ │ 2  │한국부품   │256,500,000│20.0%│38   │89.5% │96.5%│ │
│ │ 3  │대한전자   │192,750,000│15.0%│28   │85.7% │95.8%│ │
│ │ 4  │신흥전자   │128,500,000│10.0%│22   │81.8% │94.2%│ │
│ │ 5  │기타(21사) │321,250,000│25.0%│65   │88.5% │96.1%│ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│ ┌─ 구매 추이 (차트) ────────────────────────────────────────┐ │
│ │     500M ┤                         ┌───┐                    │ │
│ │     400M ┤              ┌───┐      │   │                    │ │
│ │     300M ┤    ┌───┐     │   │      │   │                    │ │
│ │     200M ┤    │   │     │   │      │   │                    │ │
│ │     100M ┤    │   │     │   │      │   │                    │ │
│ │        0 ┼────┴───┴─────┴───┴──────┴───┴────              │ │
│ │              1월       2월        3월                       │ │
│ └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

---

## 4. 테이블 설계

### 4.1 구매요청 (erp_purchase_request)
```sql
CREATE TABLE erp_purchase_request (
    pr_no VARCHAR(12) PRIMARY KEY,
    pr_date DATE NOT NULL,
    dept_code VARCHAR(10) NOT NULL,
    requester VARCHAR(50) NOT NULL,
    due_date DATE NOT NULL,
    urgent_yn CHAR(1) DEFAULT 'N',
    reason VARCHAR(500),
    status VARCHAR(10) DEFAULT '대기',
    total_amount DECIMAL(15,2) DEFAULT 0,
    approved_by VARCHAR(50),
    approved_date TIMESTAMP,
    reject_reason VARCHAR(500),
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 4.2 발주서 (erp_purchase_order)
```sql
CREATE TABLE erp_purchase_order (
    po_no VARCHAR(12) PRIMARY KEY,
    po_date DATE NOT NULL,
    vendor_code VARCHAR(10) NOT NULL,
    due_date DATE NOT NULL,
    payment_term VARCHAR(20) NOT NULL,
    delivery_loc VARCHAR(100),
    status VARCHAR(10) DEFAULT '작성',
    total_amount DECIMAL(15,2) DEFAULT 0,
    vat_amount DECIMAL(15,2) DEFAULT 0,
    grand_total DECIMAL(15,2) DEFAULT 0,
    pr_no VARCHAR(12),
    issued_at TIMESTAMP,
    issued_by VARCHAR(50),
    remarks VARCHAR(500),
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (vendor_code) REFERENCES erp_partner_master(partner_code),
    FOREIGN KEY (pr_no) REFERENCES erp_purchase_request(pr_no)
);
```

### 4.3 입고 (erp_goods_receipt)
```sql
CREATE TABLE erp_goods_receipt (
    gr_no VARCHAR(12) PRIMARY KEY,
    gr_date DATE NOT NULL,
    po_no VARCHAR(12) NOT NULL,
    warehouse_code VARCHAR(10) NOT NULL,
    receiver VARCHAR(50) NOT NULL,
    invoice_no VARCHAR(30),
    status VARCHAR(10) DEFAULT '입고중',
    total_amount DECIMAL(15,2) DEFAULT 0,
    inspector VARCHAR(50),
    inspect_date DATE,
    inspect_comment VARCHAR(500),
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (po_no) REFERENCES erp_purchase_order(po_no),
    FOREIGN KEY (warehouse_code) REFERENCES erp_warehouse_master(warehouse_code)
);
```

### 4.4 매입전표 (erp_purchase_invoice)
```sql
CREATE TABLE erp_purchase_invoice (
    pi_no VARCHAR(12) PRIMARY KEY,
    pi_date DATE NOT NULL,
    vendor_code VARCHAR(10) NOT NULL,
    tax_invoice_no VARCHAR(30),
    tax_invoice_date DATE,
    supply_amount DECIMAL(15,2) NOT NULL,
    vat_amount DECIMAL(15,2) NOT NULL,
    total_amount DECIMAL(15,2) NOT NULL,
    payment_term VARCHAR(20),
    payment_due_date DATE,
    status VARCHAR(10) DEFAULT '작성',
    gl_voucher_no VARCHAR(20),
    posted_at TIMESTAMP,
    created_by VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (vendor_code) REFERENCES erp_partner_master(partner_code)
);
```

### 4.5 공급업체 평가 (erp_vendor_evaluation)
```sql
CREATE TABLE erp_vendor_evaluation (
    eval_id SERIAL PRIMARY KEY,
    eval_period VARCHAR(10) NOT NULL,  -- 2024Q1
    vendor_code VARCHAR(10) NOT NULL,
    delivery_score DECIMAL(5,2),  -- 납기준수율 점수
    quality_score DECIMAL(5,2),   -- 품질 점수
    price_score DECIMAL(5,2),     -- 가격경쟁력 점수
    cooperation_score DECIMAL(5,2), -- 협력도 점수
    total_score DECIMAL(5,2),     -- 종합 점수
    grade CHAR(1),                -- 등급 (A/B/C/D)
    prev_grade CHAR(1),           -- 전기 등급
    eval_comment VARCHAR(500),
    evaluated_by VARCHAR(50),
    evaluated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (vendor_code) REFERENCES erp_partner_master(partner_code)
);
```

---

## 5. API 설계

### 5.1 구매요청 API
```
POST   /api/erp/purchase-request          구매요청 등록
GET    /api/erp/purchase-request          구매요청 목록 조회
GET    /api/erp/purchase-request/{pr_no}  구매요청 상세 조회
PUT    /api/erp/purchase-request/{pr_no}  구매요청 수정
POST   /api/erp/purchase-request/{pr_no}/approve  승인 처리
POST   /api/erp/purchase-request/{pr_no}/reject   반려 처리
```

### 5.2 발주 API
```
POST   /api/erp/purchase-order            발주서 등록
GET    /api/erp/purchase-order            발주서 목록 조회
GET    /api/erp/purchase-order/{po_no}    발주서 상세 조회
PUT    /api/erp/purchase-order/{po_no}    발주서 수정
POST   /api/erp/purchase-order/{po_no}/issue     발주 발행
DELETE /api/erp/purchase-order/{po_no}    발주서 삭제
GET    /api/erp/purchase-order/status     발주현황 조회
```

### 5.3 입고 API
```
POST   /api/erp/goods-receipt             입고 등록
GET    /api/erp/goods-receipt             입고 목록 조회
GET    /api/erp/goods-receipt/{gr_no}     입고 상세 조회
PUT    /api/erp/goods-receipt/{gr_no}     입고 수정
POST   /api/erp/goods-receipt/{gr_no}/confirm    입고 확정
POST   /api/erp/goods-receipt/{gr_no}/inspect    검수 처리
```

### 5.4 매입전표 API
```
POST   /api/erp/purchase-invoice          매입전표 등록
GET    /api/erp/purchase-invoice          매입전표 목록 조회
GET    /api/erp/purchase-invoice/{pi_no}  매입전표 상세 조회
POST   /api/erp/purchase-invoice/{pi_no}/post    전기 처리
DELETE /api/erp/purchase-invoice/{pi_no}  매입전표 삭제
```

### 5.5 공급업체 평가 API
```
POST   /api/erp/vendor-evaluation/execute 평가 실행
GET    /api/erp/vendor-evaluation         평가 결과 조회
GET    /api/erp/vendor-evaluation/{vendor_code}  업체별 평가 조회
```

---

## 6. MES 연동

### 6.1 입고 정보 연동
```
입고 확정 시 → mes_erp_goods_movement_if 테이블에 등록
- movement_type: 'GR' (입고)
- item_code, qty, lot_no, warehouse_code
- MES에서 자재 현황 조회 시 활용
```

### 6.2 자재 LOT 추적
```
입고 시 LOT번호 생성 규칙:
- 형식: GR + 년월일 + 공급업체코드(2자리) + 일련번호(3자리)
- 예: GR240123SE001

MES 생산 시 해당 LOT 사용 기록
→ 품질 이슈 시 역추적 가능
```

---

## 7. 초기 데이터

### 7.1 결제조건 코드
| 코드 | 명칭 | 설명 |
|------|------|------|
| CASH | 현금 | 전표일 즉시 결제 |
| NET30 | 30일 | 전표일 + 30일 |
| EOM30 | 월말30일 | 익월 말일 결제 |
| NET60 | 60일 | 전표일 + 60일 |
| NET90 | 90일 | 전표일 + 90일 |

### 7.2 구매 상태 코드
| 상태 | 설명 |
|------|------|
| 대기 | 구매요청 승인 대기 |
| 승인 | 구매요청 승인 완료 |
| 반려 | 구매요청 반려 |
| 작성 | 발주서 작성 중 |
| 발행 | 발주서 발행 완료 |
| 부분입고 | 일부 입고 완료 |
| 입고완료 | 전량 입고 완료 |
| 취소 | 발주 취소 |
