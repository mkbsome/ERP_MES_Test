# MES I/F연계 및 시스템관리 모듈 기능정의서

## 모듈 개요

### I/F(인터페이스) 연계 모듈
| 항목 | 내용 |
|------|------|
| **모듈ID** | MES-IFS |
| **모듈명** | I/F연계 |
| **화면수** | 6개 |
| **목적** | ERP 및 AI 플랫폼과의 데이터 연계 관리 |

### 시스템관리 모듈
| 항목 | 내용 |
|------|------|
| **모듈ID** | MES-SYS |
| **모듈명** | 시스템관리 |
| **화면수** | 8개 |
| **목적** | 사용자, 권한, 시스템 설정 관리 |

---

## I/F연계 화면 목록

| No | 화면ID | 화면명 | 개발우선순위 |
|----|--------|--------|-------------|
| 1 | MES-IFS-001 | ERP수주정보 | P1 |
| 2 | MES-IFS-002 | ERP품목정보 | P1 |
| 3 | MES-IFS-003 | ERP제조오더정보 | P1 |
| 4 | MES-IFS-004 | 실적전송현황 | P1 |
| 5 | MES-IFS-005 | 불량전송현황 | P2 |
| 6 | MES-IFS-006 | AI연계현황 | P2 |

## 시스템관리 화면 목록

| No | 화면ID | 화면명 | 개발우선순위 |
|----|--------|--------|-------------|
| 1 | MES-SYS-001 | 사용자설정 | P1 |
| 2 | MES-SYS-002 | 사용자그룹관리 | P1 |
| 3 | MES-SYS-003 | 그룹권한설정 | P1 |
| 4 | MES-SYS-004 | 그룹별사용자관리 | P2 |
| 5 | MES-SYS-005 | 사용자권한관리 | P2 |
| 6 | MES-SYS-006 | POP메뉴관리 | P2 |
| 7 | MES-SYS-007 | POP권한관리 | P2 |
| 8 | MES-SYS-008 | 로그인내역관리 | P2 |

---

# Part 1: I/F연계 모듈 상세

## MES-IFS-001 ERP수주정보

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-IFS-001 |
| **화면명** | ERP수주정보 |
| **화면유형** | 조회/연동 |
| **접근권한** | 시스템관리자, 생산관리자 |

### 기능설명
ERP에서 수신한 수주 정보를 조회하고 연동 상태를 확인한다.

### 데이터 항목
| 필드명 | 필드ID | 타입 | 설명 |
|--------|--------|------|------|
| 연동ID | if_id | VARCHAR(30) | PK |
| ERP수주번호 | erp_order_no | VARCHAR(30) | |
| 수주일자 | order_date | DATE | |
| 고객코드 | customer_code | VARCHAR(20) | |
| 품목코드 | item_code | VARCHAR(30) | |
| 수주수량 | order_qty | INT | |
| 납기일자 | due_date | DATE | |
| 수신일시 | received_at | TIMESTAMP | |
| 연동상태 | status | VARCHAR(20) | 수신/처리완료/오류 |
| 오류내용 | error_msg | VARCHAR(500) | |

### 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ ERP 수주정보 연동                                            │
├─────────────────────────────────────────────────────────────┤
│ [검색조건]                                                   │
│ 수신일자: [____]~[____] 상태: [전체▼] [검색] [수동동기화]    │
├─────────────────────────────────────────────────────────────┤
│ [연동 현황 요약]                                             │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│ │ 총수신   │ │ 처리완료 │ │ 대기     │ │ 오류     │           │
│ │   125   │ │   120   │ │    3    │ │    2    │           │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
├─────────────────────────────────────────────────────────────┤
│ [수주 연동 목록]                                             │
│ 수신일시│ERP수주번호│고객│품목│수량│납기│상태│오류           │
│ ───────┼─────────┼───┼───┼───┼───┼───┼───                 │
│ 14:30:25│SO-250129-01│삼성│MB-A│500│01-30│✅ 처리│           │
│ 14:25:10│SO-250129-02│LG │PW-A│300│02-01│⏳ 대기│           │
│ 14:20:05│SO-250129-03│현대│EC-B│200│02-05│❌ 오류│품목코드 불일치│
├─────────────────────────────────────────────────────────────┤
│ [선택건 처리] [재처리] [오류건 수정]                          │
└─────────────────────────────────────────────────────────────┘
```

---

## MES-IFS-002 ERP품목정보

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-IFS-002 |
| **화면명** | ERP품목정보 |
| **화면유형** | 조회/동기화 |
| **접근권한** | 시스템관리자 |

### 기능설명
ERP 품목마스터와 MES 품목정보를 동기화한다.

### 데이터 항목 (동기화 대상)
| ERP 필드 | MES 필드 | 동기화방향 |
|----------|----------|----------|
| item_code | item_code | ERP→MES |
| item_name | item_name | ERP→MES |
| item_type | item_type | ERP→MES |
| unit | unit | ERP→MES |
| customer_code | customer_code | ERP→MES |
| (없음) | uph | MES 자체관리 |
| (없음) | std_defect_rate | MES 자체관리 |

### 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ ERP 품목정보 동기화                                          │
├─────────────────────────────────────────────────────────────┤
│ [동기화 현황]                                                │
│ 최종동기화: 2025-01-29 08:00:15  자동동기화: [ON]            │
│ ERP품목: 3,250개  MES품목: 3,248개  차이: 2개                │
├─────────────────────────────────────────────────────────────┤
│ [동기화 필요 품목] (ERP에만 있거나 변경된 품목)               │
│ 품목코드│품목명│상태│ERP최종수정│MES최종동기화│차이           │
│ ───────┼─────┼───┼─────────┼──────────┼───               │
│ GB-NEW-01│신제품A│신규│01-29 14:00│-         │신규추가필요    │
│ GB-MB-005│메인보드E│변경│01-29 10:00│01-28 08:00│명칭변경      │
├─────────────────────────────────────────────────────────────┤
│ [전체동기화] [선택동기화] [동기화이력]                        │
└─────────────────────────────────────────────────────────────┘
```

---

## MES-IFS-003 ERP제조오더정보

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-IFS-003 |
| **화면명** | ERP제조오더정보 |
| **화면유형** | 조회/연동 |
| **접근권한** | 생산관리자 |

### 기능설명
ERP에서 발행된 제조오더(작업지시)를 수신하여 MES 생산지시로 변환한다.

### 데이터 항목
| 필드명 | 필드ID | 타입 | 설명 |
|--------|--------|------|------|
| 연동ID | if_id | VARCHAR(30) | PK |
| ERP제조오더 | erp_work_order | VARCHAR(30) | |
| 지시일자 | order_date | DATE | |
| 품목코드 | item_code | VARCHAR(30) | |
| 지시수량 | order_qty | INT | |
| 납기일자 | due_date | DATE | |
| 우선순위 | priority | INT | |
| 수신일시 | received_at | TIMESTAMP | |
| MES생산지시 | mes_prod_order | VARCHAR(20) | 변환된 MES 번호 |
| 연동상태 | status | VARCHAR(20) | |

### 연동 플로우
```
ERP                          MES
──────                      ─────
제조오더 발행 ───────────→ 제조오더 수신 (IF 테이블)
                                ↓
                          생산지시 변환
                                ↓
                          작업지시 분할 (라인별)
                                ↓
                          POP 배포
```

---

## MES-IFS-004 실적전송현황

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-IFS-004 |
| **화면명** | 실적전송현황 |
| **화면유형** | 조회/모니터링 |
| **접근권한** | 시스템관리자, 생산관리자 |

### 기능설명
MES에서 ERP로 전송된 생산실적 현황을 모니터링한다.

### 데이터 항목
| 필드명 | 필드ID | 타입 | 설명 |
|--------|--------|------|------|
| 전송ID | transfer_id | VARCHAR(30) | PK |
| 작업지시번호 | work_order_no | VARCHAR(20) | |
| LOT번호 | lot_no | VARCHAR(30) | |
| 양품수량 | good_qty | INT | |
| 불량수량 | defect_qty | INT | |
| 전송일시 | transferred_at | TIMESTAMP | |
| 전송상태 | status | VARCHAR(20) | 전송완료/오류/대기 |
| ERP응답 | erp_response | VARCHAR(500) | |

### 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ MES→ERP 실적전송 현황                                        │
├─────────────────────────────────────────────────────────────┤
│ [검색조건]                                                   │
│ 전송일자: [____]~[____] 상태: [전체▼] [검색] [재전송]        │
├─────────────────────────────────────────────────────────────┤
│ [전송 현황 요약]                                             │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│ │ 총전송   │ │ 성공     │ │ 대기     │ │ 실패     │           │
│ │   856   │ │   850   │ │    4    │ │    2    │           │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
├─────────────────────────────────────────────────────────────┤
│ [전송 목록]                                                  │
│ 전송시간│작업지시│LOT│양품│불량│상태│ERP응답                  │
│ ───────┼──────┼──┼───┼───┼───┼─────                       │
│ 14:35:10│WO-001│L01│100│ 2 │ ✅ │정상처리                   │
│ 14:30:05│WO-001│L01│100│ 3 │ ✅ │정상처리                   │
│ 14:25:00│WO-002│L02│ 50│ 1 │ ❌ │ERP접속오류                │
└─────────────────────────────────────────────────────────────┘
```

---

## MES-IFS-005 불량전송현황

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-IFS-005 |
| **화면명** | 불량전송현황 |
| **화면유형** | 조회 |
| **접근권한** | 시스템관리자, 품질관리자 |

### 기능설명
MES에서 ERP로 전송된 불량 정보 현황을 모니터링한다.

---

## MES-IFS-006 AI연계현황

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-IFS-006 |
| **화면명** | AI연계현황 |
| **화면유형** | 조회/모니터링 |
| **접근권한** | 시스템관리자 |

### 기능설명
AI 플랫폼과의 연계 데이터 전송/수신 현황을 모니터링한다.

### 데이터 항목
| 필드명 | 필드ID | 타입 | 설명 |
|--------|--------|------|------|
| 연계ID | ai_link_id | VARCHAR(30) | PK |
| 연계유형 | link_type | VARCHAR(20) | 품질판단/설비판단/예측 |
| 요청일시 | request_time | TIMESTAMP | |
| 요청데이터 | request_data | JSON | |
| 응답일시 | response_time | TIMESTAMP | |
| 응답데이터 | response_data | JSON | |
| 상태 | status | VARCHAR(20) | 요청/처리중/완료/오류 |
| 처리결과 | result_summary | VARCHAR(500) | |

### 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ 🤖 AI 플랫폼 연계 현황                                       │
├─────────────────────────────────────────────────────────────┤
│ [연결 상태]                                                  │
│ AI Platform: 🟢 연결됨  │  응답시간: 125ms  │  금일요청: 45건│
├─────────────────────────────────────────────────────────────┤
│ [연계 유형별 현황]                                           │
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐           │
│ │ 품질판단     │ │ 설비판단     │ │ 예측분석     │           │
│ │    28건    │ │    12건    │ │     5건    │           │
│ │ ⚠️ 3건 경고 │ │ 🔴 1건 위험 │ │ ✅ 정상    │           │
│ └─────────────┘ └─────────────┘ └─────────────┘           │
├─────────────────────────────────────────────────────────────┤
│ [최근 연계 이력]                                             │
│ 시간│유형│대상│요청내용│결과│상태                            │
│ ───┼───┼───┼──────┼───┼───                               │
│14:32│품질│SMT-L01│불량률분석│⚠️ 경고│라인점검권고            │
│14:25│설비│CHIP-02│OEE분석│🔴 위험│긴급PM요청               │
│14:10│품질│SMT-L03│불량률분석│✅ 정상│이상없음               │
├─────────────────────────────────────────────────────────────┤
│ [상세 보기]                                                  │
│ ┌─────────────────────────────────────────────────────┐   │
│ │ 요청 데이터 (JSON)                                    │   │
│ │ {                                                    │   │
│ │   "workflow_id": "defect_rule_pack",                 │   │
│ │   "input_data": {                                    │   │
│ │     "line_id": "SMT-L01",                           │   │
│ │     "defect_rate": 0.032,                           │   │
│ │     "top_defects": [{"type":"BRIDGE","count":15}]   │   │
│ │   }                                                  │   │
│ │ }                                                    │   │
│ └─────────────────────────────────────────────────────┘   │
│ ┌─────────────────────────────────────────────────────┐   │
│ │ 응답 데이터 (JSON)                                    │   │
│ │ {                                                    │   │
│ │   "judgment": "warning",                            │   │
│ │   "confidence": 0.85,                               │   │
│ │   "recommendation": "Printer 압력 점검 권고"        │   │
│ │ }                                                    │   │
│ └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

---

# Part 2: 시스템관리 모듈 상세

## MES-SYS-001 사용자설정

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-SYS-001 |
| **화면명** | 사용자설정 |
| **화면유형** | CRUD |
| **접근권한** | 시스템관리자 |

### 데이터 항목
| 필드명 | 필드ID | 타입 | 필수 | 설명 |
|--------|--------|------|------|------|
| 사용자ID | user_id | VARCHAR(20) | Y | PK |
| 사용자명 | user_name | VARCHAR(50) | Y | |
| 비밀번호 | password | VARCHAR(256) | Y | 암호화 |
| 사번 | emp_no | VARCHAR(20) | Y | |
| 부서 | dept_code | VARCHAR(20) | N | |
| 이메일 | email | VARCHAR(100) | N | |
| 연락처 | phone | VARCHAR(20) | N | |
| 사용자유형 | user_type | VARCHAR(20) | Y | 관리자/작업자/조회자 |
| 사용여부 | is_active | BOOLEAN | Y | |
| 최종로그인 | last_login | TIMESTAMP | N | |

### 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ 사용자 설정                                                  │
├─────────────────────────────────────────────────────────────┤
│ [검색] 사용자ID: [____] 사용자명: [____] 유형: [전체▼] [검색]│
├───────────────────────┬─────────────────────────────────────┤
│ [사용자 목록]          │ [사용자 상세]                        │
│ ID│이름│부서│유형│상태│ │ 사용자ID: [user001   ]            │
│ ──┼───┼───┼───┼───│ │ 사용자명: [홍길동     ]            │
│ u01│홍길동│생산1│작업자│✅│ │ 사번: [EMP001      ]              │
│ u02│김철수│생산2│작업자│✅│ │ 부서: [생산1팀▼]                  │
│ adm│관리자│IT │관리자│✅│ │ 유형: [작업자▼]                   │
│    │     │   │    │  │ │ 이메일: [hong@greenboard.com]     │
│    │     │   │    │  │ │ 연락처: [010-1234-5678]           │
│    │     │   │    │  │ │ 사용여부: [✓]                     │
├───────────────────────┴─────────────────────────────────────┤
│ [신규] [저장] [삭제] [비밀번호초기화]                         │
└─────────────────────────────────────────────────────────────┘
```

---

## MES-SYS-002 사용자그룹관리

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-SYS-002 |
| **화면명** | 사용자그룹관리 |
| **화면유형** | CRUD |
| **접근권한** | 시스템관리자 |

### 데이터 항목
| 필드명 | 필드ID | 타입 | 필수 | 설명 |
|--------|--------|------|------|------|
| 그룹코드 | group_code | VARCHAR(20) | Y | PK |
| 그룹명 | group_name | VARCHAR(100) | Y | |
| 설명 | description | VARCHAR(500) | N | |
| 사용여부 | is_active | BOOLEAN | Y | |

### 초기 데이터
| 그룹코드 | 그룹명 | 설명 |
|----------|--------|------|
| SYS_ADMIN | 시스템관리자 | 전체 시스템 관리 권한 |
| PROD_MGR | 생산관리자 | 생산관리 전체 권한 |
| QC_MGR | 품질관리자 | 품질관리 전체 권한 |
| EQP_MGR | 설비관리자 | 설비관리 전체 권한 |
| LINE_LEADER | 라인리더 | 라인별 생산/품질 권한 |
| WORKER | 작업자 | POP 화면 사용 권한 |
| VIEWER | 조회자 | 조회 전용 권한 |

---

## MES-SYS-003 그룹권한설정

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-SYS-003 |
| **화면명** | 그룹권한설정 |
| **화면유형** | 설정 |
| **접근권한** | 시스템관리자 |

### 기능설명
그룹별로 메뉴 접근 권한을 설정한다.

### 데이터 항목
| 필드명 | 필드ID | 타입 | 필수 | 설명 |
|--------|--------|------|------|------|
| 그룹코드 | group_code | VARCHAR(20) | Y | FK |
| 메뉴코드 | menu_code | VARCHAR(30) | Y | FK |
| 조회권한 | can_read | BOOLEAN | Y | |
| 등록권한 | can_create | BOOLEAN | Y | |
| 수정권한 | can_update | BOOLEAN | Y | |
| 삭제권한 | can_delete | BOOLEAN | Y | |

### 화면 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ 그룹 권한 설정                                               │
├─────────────────────────────────────────────────────────────┤
│ 그룹 선택: [생산관리자▼]                                     │
├─────────────────────────────────────────────────────────────┤
│ [메뉴별 권한 설정]                                           │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 메뉴                    │ 조회 │ 등록 │ 수정 │ 삭제     │ │
│ ├─────────────────────────┼─────┼─────┼─────┼─────────┤ │
│ │ ▼ 기준정보관리          │      │      │      │          │ │
│ │   코드그룹관리          │  ✓  │  ✓  │  ✓  │   ✓     │ │
│ │   공통코드관리          │  ✓  │  ✓  │  ✓  │   ✓     │ │
│ │   품목관리              │  ✓  │  ✓  │  ✓  │   ✓     │ │
│ │ ▼ 생산관리              │      │      │      │          │ │
│ │   생산지시관리          │  ✓  │  ✓  │  ✓  │   ✓     │ │
│ │   작업지시관리          │  ✓  │  ✓  │  ✓  │   ✓     │ │
│ │   작업실적조회          │  ✓  │  -  │  -  │   -     │ │
│ │ ▼ 품질관리              │      │      │      │          │ │
│ │   불량등록              │  ✓  │  ✓  │  -  │   -     │ │
│ │   불량현황조회          │  ✓  │  -  │  -  │   -     │ │
│ └─────────────────────────────────────────────────────────┘ │
│ [전체선택] [전체해제] [저장]                                  │
└─────────────────────────────────────────────────────────────┘
```

---

## MES-SYS-006 POP메뉴관리

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-SYS-006 |
| **화면명** | POP메뉴관리 |
| **화면유형** | 설정 |
| **접근권한** | 시스템관리자 |

### 기능설명
POP 화면의 메뉴 구성을 설정한다.

### 데이터 항목
| 필드명 | 필드ID | 타입 | 필수 | 설명 |
|--------|--------|------|------|------|
| 메뉴코드 | menu_code | VARCHAR(20) | Y | PK |
| 메뉴명 | menu_name | VARCHAR(50) | Y | |
| 메뉴아이콘 | icon | VARCHAR(50) | N | 이모지 또는 아이콘명 |
| 화면URL | screen_url | VARCHAR(200) | Y | |
| 정렬순서 | sort_order | INT | Y | |
| 사용여부 | is_active | BOOLEAN | Y | |

---

## MES-SYS-008 로그인내역관리

### 기본정보
| 항목 | 내용 |
|------|------|
| **화면ID** | MES-SYS-008 |
| **화면명** | 로그인내역관리 |
| **화면유형** | 조회 |
| **접근권한** | 시스템관리자 |

### 데이터 항목
| 필드명 | 필드ID | 타입 | 설명 |
|--------|--------|------|------|
| 로그ID | log_id | BIGINT | PK |
| 사용자ID | user_id | VARCHAR(20) | |
| 로그인일시 | login_time | TIMESTAMP | |
| 로그아웃일시 | logout_time | TIMESTAMP | |
| IP주소 | ip_address | VARCHAR(50) | |
| 접속유형 | access_type | VARCHAR(20) | WEB/POP |
| 접속기기 | device_info | VARCHAR(200) | |
| 결과 | result | VARCHAR(20) | 성공/실패 |
| 실패사유 | fail_reason | VARCHAR(200) | |

---

## 테이블 설계

### I/F 연계 테이블
| 테이블명 | 설명 |
|----------|------|
| mes_if_sales_order | ERP 수주 연동 |
| mes_if_item | ERP 품목 연동 |
| mes_if_work_order | ERP 제조오더 연동 |
| mes_if_production_result | 실적 전송 |
| mes_if_defect | 불량 전송 |
| mes_if_ai_request | AI 요청 로그 |
| mes_if_ai_response | AI 응답 로그 |

### 시스템관리 테이블
| 테이블명 | 설명 |
|----------|------|
| mes_user | 사용자 |
| mes_user_group | 사용자 그룹 |
| mes_user_group_member | 그룹-사용자 매핑 |
| mes_menu | 메뉴 |
| mes_group_permission | 그룹 권한 |
| mes_user_permission | 사용자 개별 권한 |
| mes_login_log | 로그인 이력 |

---

## API 엔드포인트

### I/F 연계
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | /api/mes/interface/sales-orders | 수주 연동 현황 |
| POST | /api/mes/interface/sales-orders/sync | 수주 동기화 |
| GET | /api/mes/interface/items | 품목 연동 현황 |
| POST | /api/mes/interface/items/sync | 품목 동기화 |
| GET | /api/mes/interface/work-orders | 제조오더 연동 |
| GET | /api/mes/interface/production-transfers | 실적 전송 현황 |
| POST | /api/mes/interface/production-transfers/retry | 재전송 |
| GET | /api/mes/interface/ai-logs | AI 연계 이력 |

### 시스템관리
| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | /api/mes/system/users | 사용자 목록 |
| POST | /api/mes/system/users | 사용자 등록 |
| PUT | /api/mes/system/users/{id} | 사용자 수정 |
| POST | /api/mes/system/users/{id}/reset-password | 비밀번호 초기화 |
| GET | /api/mes/system/groups | 그룹 목록 |
| POST | /api/mes/system/groups | 그룹 등록 |
| GET | /api/mes/system/groups/{code}/permissions | 그룹 권한 조회 |
| PUT | /api/mes/system/groups/{code}/permissions | 그룹 권한 설정 |
| GET | /api/mes/system/login-logs | 로그인 이력 |

---

*문서버전: 1.0*
*작성일: 2025-01-29*
